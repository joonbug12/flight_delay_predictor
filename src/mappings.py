# We have to map from dot codes to iata codes since they changed the airport code system in october 2015

DOT_TO_IATA = {
    '10397': 'ATL', '13930': 'ORD', '11292': 'DFW', '11298': 'DEN', '12892': 'LAX',
    '14771': 'SFO', '14107': 'PHX', '12266': 'IAH', '12889': 'LAS', '13487': 'MSP',
    '11433': 'DTW', '10721': 'BOS', '14747': 'SEA', '13204': 'MCO', '11618': 'EWR',
    '11057': 'CLT', '14100': 'PHL', '12953': 'LGA', '10693': 'BNA', '12478': 'JFK',
    '10821': 'BWI', '14869': 'SLC', '11278': 'DCA', '13303': 'MIA', '11697': 'FLL',
    '14057': 'PDX', '15304': 'TPA', '14679': 'SAN', '13495': 'MSY', '15016': 'STL',
    '12191': 'HOU', '13232': 'MDW', '12264': 'IAD', '10529': 'BDL', '10423': 'AUS',
    '12896': 'LBB', '14831': 'SJC', '13891': 'ONT', '12954': 'LGB', '14122': 'PIT',
    '14893': 'SMF', '11042': 'CLE', '12339': 'IND', '11066': 'CMH', '13198': 'MCI',
    '10792': 'BUF', '13244': 'MEM', '15376': 'TUS', '14843': 'SJU', '11259': 'DAL',
    '13830': 'OGG', '12173': 'HNL', '13342': 'MKE', '14570': 'RNO', '14108': 'PIA',
    '13796': 'OAK', '15370': 'TUL', '14524': 'RIC', '13871': 'OMA', '13851': 'OKC',
    '14492': 'RDU', '12451': 'JAX', '11637': 'FAR', '14576': 'ROC', '14635': 'RSW',
    '14698': 'SBA', '14730': 'SDF', '10257': 'ALB', '10299': 'ANC', '11003': 'CID',
    '14307': 'PVD', '12891': 'LAW', '10140': 'ABQ', '10599': 'BHM', '10620': 'BIL',
    '10627': 'BIS', '10713': 'BOI', '10728': 'BQK', '10731': 'BQN', '10732': 'BQN',
    '10739': 'BPT', '10747': 'BRO', '10754': 'BTM', '10781': 'BTR', '10785': 'BTV',
    '10792': 'BUF', '10800': 'BUR', '10849': 'BZN', '10868': 'CAE', '10874': 'CAK',
    '10980': 'CHA', '10994': 'CHS', '11042': 'CLE', '11049': 'CLL', '11057': 'CLT',
    '11066': 'CMH', '11067': 'CMI', '11109': 'COS', '11111': 'COU', '11122': 'CPR',
    '11140': 'CRP', '11146': 'CRW', '11150': 'CSG', '11193': 'CVG', '11203': 'CWA',
    '11252': 'DAB', '11259': 'DAL', '11267': 'DAY', '11274': 'DBQ', '11278': 'DCA',
    '11292': 'DFW', '11298': 'DEN', '11308': 'DHN', '11337': 'DLG', '11338': 'DLH',
    '11389': 'DRO', '11413': 'DSM', '11423': 'DTW', '11433': 'DTW', '11481': 'ECP',
    '11525': 'EKO', '11537': 'ELM', '11540': 'ELP', '11577': 'ERI', '11587': 'ESC',
    '11603': 'EUG', '11612': 'EVV', '11617': 'EWN', '11618': 'EWR', '11624': 'EYW',
    '11630': 'FAI', '11637': 'FAR', '11638': 'FAT', '11640': 'FAY', '11641': 'FCA',
    '11648': 'FKS', '11695': 'FLG', '11697': 'FLL', '11721': 'FNT', '11775': 'FSD',
    '11778': 'FSM', '11823': 'FWA', '11865': 'GCC', '11867': 'GCK', '11884': 'GEG',
    '11898': 'GFK', '11905': 'GGG', '11921': 'GJT', '11953': 'GNV', '11973': 'GPT',
    '11977': 'GRB', '11980': 'GRI', '11982': 'GRK', '11986': 'GRR', '11995': 'GSO',
    '11996': 'GSP', '12003': 'GTF', '12007': 'GTR', '12012': 'GUC', '12016': 'GUM',
    '12094': 'HDN', '12156': 'HIB', '12173': 'HNL', '12191': 'HOU', '12197': 'HPN',
    '12206': 'HRL', '12217': 'HSV', '12250': 'HYS', '12255': 'IAD', '12264': 'IAD',
    '12265': 'IAG', '12266': 'IAH', '12278': 'ICT', '12280': 'IDA', '12323': 'ILM',
    '12335': 'IMT', '12339': 'IND', '12343': 'INL', '12389': 'ISN', '12391': 'ISP',
    '12397': 'ITH', '12402': 'ITO', '12441': 'JAC', '12448': 'JAN', '12451': 'JAX',
    '12478': 'JFK', '12511': 'JLN', '12519': 'JMS', '12523': 'JNU', '12542': 'JST',
    '12758': 'KOA', '12819': 'KTN', '12884': 'LAN', '12888': 'LAR', '12889': 'LAS',
    '12891': 'LAW', '12892': 'LAX', '12896': 'LBB', '12898': 'LBE', '12915': 'LCH',
    '12945': 'LEX', '12951': 'LFT', '12953': 'LGA', '12954': 'LGB', '12982': 'LIH',
    '12992': 'LIT', '13024': 'LNK', '13029': 'LNK', '13061': 'LRD', '13076': 'LSE',
    '13122': 'LWS', '13158': 'MAF', '13184': 'MBS', '13198': 'MCI', '13204': 'MCO',
    '13230': 'MDT', '13232': 'MDW', '13244': 'MEM', '13256': 'MFE', '13264': 'MFR',
    '13277': 'MGM', '13290': 'MHK', '13296': 'MHT', '13303': 'MIA', '13342': 'MKE',
    '13344': 'MKG', '13360': 'MLB', '13367': 'MLI', '13377': 'MLU', '13388': 'MMH',
    '13422': 'MOB', '13433': 'MOT', '13459': 'MQT', '13476': 'MRY', '13485': 'MSN',
    '13486': 'MSO', '13487': 'MSP', '13495': 'MSY', '13502': 'MTJ', '13541': 'MVY',
    '13577': 'MYR', '13795': 'OAJ', '13796': 'OAK', '13830': 'OGG', '13851': 'OKC',
    '13871': 'OMA', '13873': 'OME', '13891': 'ONT', '13930': 'ORD', '13931': 'ORF',
    '13933': 'ORH', '13964': 'OTH', '13970': 'OTZ', '13987': 'PAH', '14004': 'PBI',
    '14006': 'PBG', '14025': 'PDX', '14027': 'PBI', '14057': 'PDX', '14082': 'PHF',
    '14100': 'PHL', '14107': 'PHX', '14108': 'PIA', '14109': 'PIB', '14112': 'PIH',
    '14113': 'PIR', '14122': 'PIT', '14150': 'PLN', '14193': 'PNS', '14222': 'PPG',
    '14252': 'PSC', '14254': 'PSE', '14256': 'PSG', '14262': 'PSP', '14307': 'PVD',
    '14314': 'PVU', '14321': 'PWM', '14457': 'RAP', '14487': 'RDD', '14489': 'RDM',
    '14492': 'RDU', '14512': 'RFD', '14520': 'RHI', '14524': 'RIC', '14543': 'RKS',
    '14570': 'RNO', '14574': 'ROA', '14576': 'ROC', '14588': 'ROW', '14633': 'RST',
    '14635': 'RSW', '14674': 'SAF', '14679': 'SAN', '14683': 'SAT', '14685': 'SAV',
    '14689': 'SBA', '14696': 'SBN', '14698': 'SBP', '14709': 'SCC', '14711': 'SCE',
    '14730': 'SDF', '14747': 'SEA', '14771': 'SFO', '14783': 'SGF', '14794': 'SGU',
    '14814': 'SHV', '14828': 'SIT', '14831': 'SJC', '14842': 'SJT', '14843': 'SJU',
    '14869': 'SLC', '14877': 'SLE', '14893': 'SMF', '14905': 'SMX', '14908': 'SNA',
    '14952': 'SPI', '14955': 'SPN', '14960': 'SPS', '14986': 'SRQ', '15008': 'STC',
    '15016': 'STL', '15023': 'STS', '15024': 'STT', '15027': 'STX', '15041': 'SUN',
    '15048': 'SUX', '15070': 'SWF', '15096': 'SYR', '15249': 'TLH', '15295': 'TOL',
    '15304': 'TPA', '15323': 'TRI', '15356': 'TTN', '15370': 'TUL', '15376': 'TUS',
    '15380': 'TVC', '15389': 'TWF', '15401': 'TXK', '15411': 'TYR', '15412': 'TYS',
    '15454': 'UST', '15497': 'VLD', '15582': 'VPS', '15607': 'WRG', '15624': 'WYS',
    '15646': 'XNA', '15841': 'YAK', '15919': 'YUM'
}

def get_airport_code(val):
    val = str(val).strip().upper()
    if len(val) == 3 and val.isalpha():
        return val
        
    return DOT_TO_IATA.get(val, None)